import{f as q,g as F,e as C,a as T,j as a,l as m,R as V,s as i,S as B,B as D,n as y,T as N,o as E,H as R}from"./index-CoApRtb5.js";import{S as k}from"./Sub_Loader-B9AjCsNp.js";function H({post:e}){var x,f,h,b,j;const{register:r,handleSubmit:S,setValue:w,getValues:v,watch:I,formState:{errors:l,isSubmitting:u}}=q({defaultValues:{title:(e==null?void 0:e.title)||"",slug:(e==null?void 0:e.$id)||"",content:(e==null?void 0:e.content)||"",status:(e==null?void 0:e.status)||"active",category:(e==null?void 0:e.category)||""}}),d=F(),g=C(),o=T(t=>t.auth.userData),$=async t=>{if(e){const s=t.image[0]?await i.uploadFile(t.image[0]):null;s&&i.deleteFile(e.featuredImage);const c=await i.updatePost({slug:e.$id,content:t.content,title:t.title,featuredImage:s?s.$id:e.featuredImage});c&&(d(y(c)),g(`/post/${c.$id}`),N({message:"Post Successfully Updated"}))}else{const s=await i.uploadFile(t.image[0]);if(s){console.log(s.bucketId);const c=new Image;c.src=i.getFilePreview(s.bucketId);const P=s.$id;t.featuredImage=P;const n=await i.createPost({...t,userId:o.$id,userName:o.name});n?(d(y(n)),g(`/post/${n.$id}`),N({message:"Post Successfully Created"})):E.error("Failed to create post !!",{position:"top-center",autoClose:1500,pauseOnHover:!0,transition:R,theme:"light"})}}};return console.log(I("content")),a.jsxs("form",{onSubmit:S($),className:"flex flex-wrap mt-5",children:[a.jsxs("div",{className:"w-full md:w-2/3 px-2",children:[a.jsx(m,{label:"Title :",placeholder:"Title",className:"",...r("title",{required:"Title is required"})}),l.title&&a.jsx("p",{className:"text-red-600 text-[0.8rem] m-0 mb-4",role:"alert",children:(x=l.title)==null?void 0:x.message}),a.jsx(m,{label:"Slug :",placeholder:"Slug",className:"",...r("slug",{required:"Slug is required",pattern:{value:/^[a-zA-Z0-9._-]+$/,message:"Slug chars must only within this chars boundary : a-z, A-Z, 0-9, period, hyphen, and underscore"},maxLength:{value:36,message:"Slug cannot exceed max length of 36"}})}),l.slug&&a.jsx("p",{className:"text-red-600 text-[0.8rem] m-0 mb-4",role:"alert",children:(f=l.slug)==null?void 0:f.message}),a.jsx(V,{label:"Content :",defaultValue:v("content"),onChange:t=>{w("content",t)},...r("content")}),l.content&&a.jsx("p",{className:"text-red-600 text-[0.8rem] m-0 mb-4",role:"alert",children:(h=l.content)==null?void 0:h.message})]}),a.jsxs("div",{className:"w-full md:w-1/3 px-2 mt-5 md:mt-0",children:[a.jsx(m,{label:"Featured Image :",type:"file",className:"",accept:"image/png, image/jpg, image/jpeg, image/gif",...r("image",!(e!=null&&e.$id)&&{required:"Image is required"})}),l.image&&a.jsx("p",{className:"text-red-600 text-[0.8rem] m-0 mb-4",role:"alert",children:(b=l.image)==null?void 0:b.message}),a.jsx(m,{label:"Category :",type:"text",className:"",placeholder:"category",...r("category",!(e!=null&&e.$id)&&{required:"Category is required"})}),l.category&&a.jsx("p",{className:"text-red-600 text-[0.8rem] m-0 mb-4",role:"alert",children:(j=l.category)==null?void 0:j.message}),e&&a.jsx("div",{className:"w-full ",children:a.jsx("img",{src:i.getFilePreview(e.featuredImage),alt:e.title,className:"rounded-lg"})}),a.jsx(B,{options:["active","inactive"],label:"Status",className:"",...r("status",{required:!0})}),u?a.jsx(k,{}):a.jsx(D,{disabled:u,className:"mt-2 w-full text-center",type:"submit",bgColor:e?"bg-green-500":void 0,children:e?"Update":"Submit"})]})]})}export{H as P};
