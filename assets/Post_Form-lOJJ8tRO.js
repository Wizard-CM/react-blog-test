import{f as p,a as P,j as t,g as c,R as $,s as r,S as q,T as j,B as F,H as C}from"./index-d02eNFuI.js";import{u as T,B as V}from"./Button-BtXGTEQq.js";import{S as B}from"./Sub_Loader-DHvCsVYp.js";function A({post:e}){var d,x,f,h,b;const{register:i,handleSubmit:N,setValue:S,getValues:w,watch:y,formState:{errors:s,isSubmitting:u}}=T({defaultValues:{title:(e==null?void 0:e.title)||"",slug:(e==null?void 0:e.$id)||"",content:(e==null?void 0:e.content)||"",status:(e==null?void 0:e.status)||"active"}}),o=p(),g=P(a=>a.auth.userData),v=async a=>{if(console.log(a),e){const l=a.image[0]?await r.uploadFile(a.image[0]):null;l&&r.deleteFile(e.featuredImage);const m=await r.updatePost({slug:e.$id,content:a.content,title:a.title,featuredImage:l?l.$id:e.featuredImage});console.log(m),m&&(o(`/post/${m.$id}`),j({message:"Post Successfully Updated"}))}else{const l=await r.uploadFile(a.image[0]);if(l){console.log(l.bucketId);const m=new Image;m.src=r.getFilePreview(l.bucketId);const I=l.$id;a.featuredImage=I;const n=await r.createPost({...a,userId:g.$id,userName:g.name});n?(o(`/post/${n.$id}`),j({message:"Post Successfully Created"})):(console.log(n),F.error("Failed to create post !!",{position:"top-center",autoClose:1500,pauseOnHover:!0,transition:C,theme:"light"}))}}};return console.log(y("content")),t.jsxs("form",{onSubmit:N(v),className:"flex flex-wrap mt-5",children:[t.jsxs("div",{className:"w-full md:w-2/3 px-2",children:[t.jsx(c,{label:"Title :",placeholder:"Title",className:"",...i("title",{required:"Title is required"})}),s.title&&t.jsx("p",{className:"text-red-600 text-[0.8rem] m-0 mb-4",role:"alert",children:(d=s.title)==null?void 0:d.message}),t.jsx(c,{label:"Slug :",placeholder:"Slug",className:"",...i("slug",{required:"Slug is required",pattern:{value:/^[a-zA-Z0-9._-]+$/,message:"Slug chars must only within this chars boundary : a-z, A-Z, 0-9, period, hyphen, and underscore"},maxLength:{value:36,message:"Slug cannot exceed max length of 36"}})}),s.slug&&t.jsx("p",{className:"text-red-600 text-[0.8rem] m-0 mb-4",role:"alert",children:(x=s.slug)==null?void 0:x.message}),t.jsx($,{label:"Content :",defaultValue:w("content"),onChange:a=>{S("content",a)},...i("content")}),s.content&&t.jsx("p",{className:"text-red-600 text-[0.8rem] m-0 mb-4",role:"alert",children:(f=s.content)==null?void 0:f.message})]}),t.jsxs("div",{className:"w-full md:w-1/3 px-2 mt-5 md:mt-0",children:[t.jsx(c,{label:"Featured Image :",type:"file",className:"",accept:"image/png, image/jpg, image/jpeg, image/gif",...i("image",{required:"Image is required"})}),s.image&&t.jsx("p",{className:"text-red-600 text-[0.8rem] m-0 mb-4",role:"alert",children:(h=s.image)==null?void 0:h.message}),t.jsx(c,{label:"Category :",type:"text",className:"",placeholder:"category",...i("category",{required:"Category is required"})}),s.category&&t.jsx("p",{className:"text-red-600 text-[0.8rem] m-0 mb-4",role:"alert",children:(b=s.category)==null?void 0:b.message}),e&&t.jsx("div",{className:"w-full ",children:t.jsx("img",{src:r.getFilePreview(e.featuredImage),alt:e.title,className:"rounded-lg"})}),t.jsx(q,{options:["active","inactive"],label:"Status",className:"",...i("status",{required:!0})}),u?t.jsx(B,{}):t.jsx(V,{disabled:u,className:"mt-2 w-full text-center",type:"submit",bgColor:e?"bg-green-500":void 0,children:e?"Update":"Submit"})]})]})}export{A as P};
